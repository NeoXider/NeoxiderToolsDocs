# Компонент Spawner

## 1. Введение

`Spawner` — это мощный и гибкий компонент для создания объектов в вашей игре. Он объединяет в себе несколько продвинутых функций, таких как:
- **Пул объектов**: Для оптимизации производительности и снижения нагрузки на сборщик мусора.
- **Взвешенный случайный выбор**: Для спавна разных типов объектов с заданной вероятностью.
- **Области спавна**: Для создания объектов в случайных точках внутри заданного коллайдера.
- **Непрерывный спавн**: Для автоматического создания объектов с заданным интервалом.

Этот компонент идеально подходит для создания волн врагов, генерации ресурсов, спавна снарядов или любых других ситуаций, где требуется контролируемое и оптимизированное создание объектов.

---

## 2. Описание класса

### Spawner
- **Пространство имен**: `Neo`
- **Путь к файлу**: `Assets/Neoxider/Scripts/Tools/Spawner/Spawner.cs`

**Описание**
Компонент, который управляет процессом создания объектов. Он может работать как в режиме непрерывного спавна, так и по запросу, используя пулинг объектов и систему шансов для выбора префаба и места спавна.

**Ключевые поля**

### Настройки спавна
- `_prefabs` (`GameObject[]`): Массив префабов, которые могут быть созданы этим спавнером.
- `_chanceData` (`ChanceData`): (Опционально) Ссылка на ScriptableObject `ChanceData`. Если задан, спавнер будет использовать его для взвешенного случайного выбора префаба из `_prefabs`.
- `spawnLimit` (`int`): Максимальное количество объектов, которое будет создано. Если `0`, спавн будет бесконечным.
- `_minSpawnDelay`, `_maxSpawnDelay` (`float`): Минимальная и максимальная задержка между спавном объектов в режиме непрерывного спавна.

### Прочие настройки
- `_spawnTransform` (`Transform`): Родительский `Transform` для всех создаваемых объектов. Если не задан, используется `Transform` самого спавнера.
- `_spawnOnAwake` (`bool`): Если `true`, непрерывный спавн начнется автоматически при старте сцены.

### Пул объектов
- `_objectPools` (`ObjectPool<GameObject>[]`): Массив пулов объектов. **Важно**: Каждый элемент этого массива должен соответствовать префабу в массиве `_prefabs` по индексу. Если пул для конкретного префаба не задан, будет использоваться обычный `Instantiate`.

### Область спавна
- `_spawnAreaCollider` (`Collider`): (Для 3D) Коллайдер, внутри которого будут случайно спавниться объекты. Поддерживает `BoxCollider`, `SphereCollider`, `CapsuleCollider`.
- `_spawnAreaCollider2D` (`Collider2D`): (Для 2D) Коллайдер, внутри которого будут случайно спавниться объекты. Поддерживает `BoxCollider2D`, `CircleCollider2D`.

**Публичные методы (Public Methods)**
- `StartSpawn()`: Запускает непрерывный спавн объектов.
- `SetSpawning(bool active)`: Включает или отключает непрерывный спавн.
- `SpawnObject(Vector3? pos = null, int id = 0, Transform transform = null)`: Создает объект вручную. Позволяет указать позицию, ID префаба из массива `_prefabs` и родительский `Transform`.
- `SpawnObjectWithCollider(int id = 0)`: Создает объект по ID префаба в случайной точке внутри заданной области спавна.
- `SpawnObjectWithCollider(GameObject prefab)`: Создает указанный префаб в случайной точке внутри заданной области спавна.
- `GetSpawnPosition()`: Возвращает случайную позицию внутри настроенной области спавна.
- `Clear()`: Удаляет/возвращает в пул все объекты, созданные этим спавнером. Останавливает непрерывный спавн.
- `GetActiveObjectCount()`: Возвращает количество активных объектов, созданных этим спавнером.

---

## 3. Как использовать

1.  Добавьте компонент `Spawner` на пустой `GameObject` в вашей сцене.
2.  **Настройте префабы**: Заполните массив `_prefabs` объектами, которые вы хотите спавнить.
3.  **Настройте пулинг (для оптимизации)**:
    -   Для каждого префаба в `_prefabs`, который вы хотите пулить, создайте экземпляр `ObjectPool<GameObject>` (например, в `Awake()` другого скрипта).
    -   Инициализируйте каждый пул с соответствующим префабом.
    -   Перетащите эти инициализированные пулы в массив `_objectPools` в инспекторе `Spawner`, убедившись, что порядок пулов соответствует порядку префабов.
4.  **Настройте область спавна**: Добавьте `Collider` или `Collider2D` на объект спавнера (или на отдельный `GameObject`) и перетащите его в поле `_spawnAreaCollider` или `_spawnAreaCollider2D`.
5.  **Запустите спавн**: Вызовите `StartSpawn()` для непрерывного спавна или `SpawnObject()` для ручного.
