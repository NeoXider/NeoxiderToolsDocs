# Компонент Drawer (Рисование)

## 1. Введение

`Drawer` — это комплексное решение для реализации механики рисования линий в реальном времени. Если в вашей игре нужно, чтобы игрок мог рисовать пальцем или мышью, этот компонент берет на себя всю сложную работу: от создания и сглаживания линии до добавления к ней физического коллайдера и управления ее жизненным циклом.

Этот инструмент невероятно гибок и подходит для множества задач: от головоломок, где нужно нарисовать путь, до игровых механик, где рисунок становится физическим объектом в мире.

---

## 2. Описание класса

### Drawer
- **Пространство имен**: `Neo.Tools`
- **Путь к файлу**: `Assets/Neoxider/Scripts/Tools/Draw/Drawer.cs`

**Описание**
Компонент, который отслеживает ввод пользователя (мышь или касание) для создания и управления объектами `LineRenderer`. Он обладает огромным количеством настроек для кастомизации внешнего вида, поведения и физики рисуемых линий.

---

## 3. Настройка компонента

Настройки разделены на несколько логических блоков, аналогично тому, как они выглядят в инспекторе.

### 3.1. Визуальные параметры

Вы можете либо использовать `templateRenderer` для копирования всех визуальных настроек, либо задать их вручную.

- `useTemplateSettings`: Если `true`, большинство настроек ниже будут проигнорированы, и вместо них будут использованы параметры из `templateRenderer`.
- `lineMaterial`, `lineSprite`, `lineTexture`: Материал и текстура для линии.
- `color`: Градиент цвета линии.
- `lineWidth`, `useWidthCurve`, `widthCurve`: Настройки ширины линии.
- `sortingLayerName`, `sortingOrder`: Сортировочный слой и порядок для корректного отображения поверх других спрайтов.

### 3.2. Алгоритмы рисования

- `smoothing`: Количество проходов сглаживания по алгоритму Чайкина. `0` — без сглаживания. `2-3` — хороший баланс между гладкостью и производительностью.
- `minPointDistance`: Минимальное расстояние между точками, чтобы линия не становилась слишком плотной.
- `maxPoints`: Максимальное количество точек в линии. Помогает ограничивать производительность.
- `fixedLength`: Если больше нуля, сегменты линии будут иметь фиксированную длину.
- `useFolow`: Если `true`, последний сегмент линии будет "тянуться" за курсором, создавая эффект живого рисования.

### 3.3. Жизненный цикл и Физика

- `minCountCreate`, `minDistanceCreate`: Условия, при которых линия считается "слишком короткой" и удаляется после завершения рисования.
- `deleteAfterRelease`: Если больше нуля, завершенная линия будет автоматически удалена через указанное количество секунд.
- `drawRelease`: Если больше нуля, процесс рисования автоматически прервется через указанное количество секунд.
- `addCollider`: Если `true`, к завершенной линии будет добавлен `EdgeCollider2D`.
- `colliderAfterCreation`: Если `true`, коллайдер будет добавлен после завершения линии. Если `false` — будет создаваться и обновляться в процессе рисования.

---

## 4. Публичные методы и свойства

- `BeginLine(Vector3 position)`: Принудительно начать рисование линии в указанной мировой позиции.
- `AppendPoint(Vector3 worldPos)`: Добавить точку к текущей линии.
- `EndLine()`: Принудительно завершить рисование текущей линии.
- `DeleteAll()`: Удалить все линии, созданные этим компонентом.
- `Distance` (свойство): Возвращает длину текущей рисуемой линии.
- `CountPoints` (свойство): Возвращает количество точек в текущей линии.

---

## 5. Unity Events

- `OnLineCreated` (`UnityEvent<LineRenderer>`): Вызывается, когда линия успешно создана и завершена. Передает ссылку на `LineRenderer` созданной линии.
- `OnLineStarted` (`UnityEvent<Vector3>`): Вызывается в момент начала рисования. Передает стартовую позицию.
- `OnDistanceChanged` (`UnityEvent<float>`): Вызывается в процессе рисования при изменении длины линии.
- `OnPointChanged` (`UnityEvent<int>`): Вызывается при добавлении новой точки. Передает общее количество точек.
- `OnTimerChanged` (`UnityEvent<float>`): Вызывается каждый кадр во время рисования. Передает время в секундах с начала рисования.
- `OnRemainingPercent` (`UnityEvent<float>`): Если используется `drawRelease`, этот ивент вызывается каждый кадр и передает оставшееся время рисования в процентах (0-1).

---

## 6. Зависимости

- Использует метод расширения `.Delay()` из пространства имен `Neo.Extensions`.
- Имеет опциональную поддержку атрибута `[Button]` из ассета `Odin Inspector` для удобного вызова методов из инспектора.
