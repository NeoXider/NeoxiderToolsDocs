# Компонент Bootstrap

## 1. Введение

В Unity порядок вызова методов `Awake()` и `Start()` у разных скриптов может быть непредсказуемым. Это часто приводит к ошибкам, когда один менеджер пытается обратиться к другому, который еще не успел инициализироваться. Компонент `Bootstrap` решает эту проблему, создавая централизованную и контролируемую последовательность инициализации для всех важных систем игры.

Вместо того чтобы полагаться на `Awake()`, ваши компоненты реализуют интерфейс `IInit` и задают себе приоритет. `Bootstrap` на старте игры находит все такие компоненты и вызывает их методы `Init()` в строгом порядке, от высшего приоритета к низшему.

---

## 2. Интерфейс IInit

Это контракт, который должен реализовать любой класс, желающий быть частью системы `Bootstrap`.

```csharp
public interface IInit
{
    // Метод, в котором должна происходить вся инициализация
    void Init();

    // Приоритет. Компоненты с большим числом инициализируются раньше.
    int InitPriority { get; }
}
```

---

## 3. Описание класса

### Bootstrap
- **Пространство имен**: `Neo`
- **Путь к файлу**: `Assets/Neoxider/Scripts/Tools/Managers/Bootstrap.cs`

**Описание**
Это компонент, который должен находиться на постоянном (`DontDestroyOnLoad`) объекте на сцене. В своем методе `Awake()` он находит все объекты, реализующие `IInit`, сортирует их по приоритету и вызывает их методы `Init()`.

**Ключевые поля**
- `_manualInitializables`: Список, в который можно вручную перетащить компоненты для гарантированной инициализации.
- `_autoFindComponents`: Если `true`, `Bootstrap` автоматически найдет **все** компоненты с интерфейсом `IInit` на сцене.

**Публичные методы**
- `Register(IInit initializable)`: Позволяет компонентам, созданным во время выполнения игры (а не размещенным на сцене заранее), зарегистрировать себя в системе `Bootstrap` и немедленно инициализироваться.

---

## 4. Как использовать

1.  Создайте на сцене пустой `GameObject`, назовите его, например, `_Bootstrap` или `_GameManagers`.
2.  Добавьте на него компонент `Bootstrap`. Этот объект будет существовать на протяжении всей игры.
3.  Создайте свой собственный менеджер (например, `ScoreManager`) и заставьте его реализовать интерфейс `IInit`.

    ```csharp
    public class ScoreManager : MonoBehaviour, IInit
    {
        // Реализуем свойство из интерфейса
        public int InitPriority => 90; // Приоритет ниже, чем у зависимостей

        // Реализуем метод из интерфейса
        public void Init()
        {
            Debug.Log("ScoreManager инициализирован!");
            // Ваша логика, которая раньше была в Awake()
        }
    }
    ```
4.  Добавьте ваш `ScoreManager` на сцену.
5.  В инспекторе `Bootstrap` либо перетащите ваш `ScoreManager` в список `_manualInitializables`, либо просто включите `_autoFindComponents`.

Теперь при запуске игры `Bootstrap` гарантированно вызовет метод `Init()` у вашего `ScoreManager` в правильном порядке.
