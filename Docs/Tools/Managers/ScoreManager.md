# Компонент Score Manager

## 1. Введение

`ScoreManager` — это централизованный синглтон для управления всем, что связано с очками игрока. Он отслеживает текущий счет, сохраняет и загружает лучший результат между сессиями, а также включает в себя гибкую систему для расчета "звезд" на основе прогресса или набранных очков.

Этот компонент избавляет вас от необходимости вручную обновлять текстовые поля с очками или писать логику для сохранения рекордов. Вы просто вызываете метод `Add()`, а менеджер делает все остальное.

---

## 2. Описание класса

### ScoreManager
- **Пространство имен**: `Neo.Tools`
- **Путь к файлу**: `Assets/Neoxider/Scripts/Tools/Managers/ScoreManager.cs`

**Описание**
Синглтон, который служит единым источником правды для всех данных, связанных с очками. Он автоматически сохраняет лучший результат в `PlayerPrefs` и предоставляет события для реакции на любые изменения.

### 2.1. Основные настройки и свойства
- `Score`: Текущие очки игрока.
- `BestScore`: Лучший результат, который автоматически загружается при старте и сохраняется при обновлении.
- `_keySave`: Ключ, по которому лучший результат сохраняется в `PlayerPrefs`.

### 2.2. Интеграция с UI
- `textScores`: Массив текстовых полей (`TMP_Text`), которые будут автоматически обновляться при изменении текущего счета.
- `textBestScores`: Массив текстовых полей для отображения лучшего счета.

### 2.3. Система звезд
- `TargetScore`: Целевое количество очков для уровня. Используется для расчета прогресса.
- `Progress`: Прогресс до `TargetScore` в диапазоне от 0 до 1.
- `starScores`: Массив пороговых значений для получения звезд. Например, `{0.25, 0.5, 0.9}` означает, что первая звезда дается за 25% прогресса, вторая за 50%, третья за 90%.
- `CountStars`: Свойство, возвращающее текущее количество заработанных звезд.

**Публичные методы**
- `Add(int amount)`: Добавляет `amount` к текущему счету.
- `Set(int amount)`: Устанавливает текущий счет в `amount`.
- `ResetScore()`: Сбрасывает текущий счет до 0.
- `ResetBestScore()`: Сбрасывает сохраненный лучший результат.

**Unity Events**
- `OnValueChange`: Вызывается при изменении `Score`. Передает новое значение.
- `OnBestValueChange`: Вызывается при обновлении `BestScore`.
- `OnProgressChange`: Вызывается при изменении `Progress`. Передает прогресс (0-1).
- `OnStarChange`: Вызывается, когда количество заработанных звезд меняется.

---

## 3. Как использовать

1.  Поместите компонент `ScoreManager` на постоянный объект-менеджер на вашей сцене.
2.  В инспекторе перетащите ваши `TextMeshPro` объекты для отображения очков в массивы `textScores` и `textBestScores`.
3.  Если вы используете систему звезд, установите `TargetScore` и заполните массив `starScores`.
4.  Из любого другого скрипта, где игрок должен получать очки, вызовите статический метод:

    ```csharp
    // Добавить 10 очков
    ScoreManager.I.Add(10);
    ```
5.  Менеджер автоматически обновит все текстовые поля, проверит, не побит ли лучший результат, и пересчитает количество звезд.
