# Компонент Mouse Input Manager

## 1. Введение

`MouseInputManager` — это централизованный синглтон для обработки всех действий мыши в вашем проекте. Его главная цель — заменить множество вызовов `Input.GetMouseButtonDown` и `Physics.Raycast` в разных скриптах на единую, оптимизированную и событийно-ориентированную систему.

Вместо того чтобы каждый компонент самостоятельно проверял клики, он может просто подписаться на события этого менеджера. Это не только упорядочивает код, но и значительно повышает производительность, так как менеджер выполняет всего один рейкаст за кадр и спроектирован так, чтобы не создавать "мусор" (GC allocations).

---

## 2. Структура данных

### MouseEventData
Каждое событие мыши передает подписчикам структуру `MouseEventData`, которая содержит всю необходимую информацию о событии:
- `ScreenPosition` (`Vector2`): Позиция курсора на экране.
- `WorldPosition` (`Vector3`): Позиция курсора в мировом пространстве.
- `HitObject` (`GameObject`): Объект, по которому попал луч.
- `Hit3D` (`RaycastHit`): Полная информация о попадании в 3D-коллайдер.
- `Hit2D` (`RaycastHit2D`): Полная информация о попадании в 2D-коллайдер.

---

## 3. Описание класса

### MouseInputManager
- **Пространство имен**: Глобальное (является синглтоном `Neo.Tools.Singleton<MouseInputManager>`)
- **Путь к файлу**: `Assets/Neoxider/Scripts/Tools/Input/MouseInputManager.cs`

**Описание**
Этот компонент должен существовать в сцене в единственном экземпляре. Он отслеживает состояние левой кнопки мыши и вызывает соответствующие C#-события, на которые могут подписаться другие скрипты.

**Ключевые поля**
- `enablePress`, `enableHold`, `enableRelease`, `enableClick`: Флаги, позволяющие включать или отключать генерацию соответствующих событий для оптимизации.
- `interactableLayers` (`LayerMask`): Маска слоев, с которыми может взаимодействовать курсор. Все остальные слои будут проигнорированы.

**C# События (Events)**
Это — сердце компонента. Другие скрипты подписываются на них, чтобы реагировать на ввод.
- `OnPress`: Вызывается в кадре, когда левая кнопка мыши была нажата.
- `OnHold`: Вызывается в каждом кадре, пока левая кнопка мыши удерживается (если включено).
- `OnRelease`: Вызывается в кадре, когда левая кнопка мыши была отпущена.
- `OnClick`: Вызывается при отпускании кнопки, но только если нажатие и отпускание произошли на одном и том же объекте.

---

## 4. Пример использования

Чтобы использовать менеджер, вам не нужно ссылаться на него в инспекторе. Достаточно получить доступ к его синглтону `I` и подписаться на нужные события.

```csharp
using UnityEngine;

public class MyClickListener : MonoBehaviour
{
    private void OnEnable()
    {
        // Подписываемся на событие нажатия
        MouseInputManager.I.OnPress += HandlePress;
    }

    private void OnDisable()
    {
        // Обязательно отписываемся, чтобы избежать утечек памяти
        if (MouseInputManager.I != null) // Проверка на случай, если менеджер уже уничтожен
        {
            MouseInputManager.I.OnPress -= HandlePress;
        }
    }

    private void HandlePress(MouseInputManager.MouseEventData data)
    {
        if (data.HitObject != null)
        {
            Debug.Log($"Нажали на объект: {data.HitObject.name} в точке {data.WorldPosition}");
        }
    }
}
```
